<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Choosing your subsets · InPhyNet.jl</title><meta name="title" content="Choosing your subsets · InPhyNet.jl"/><meta property="og:title" content="Choosing your subsets · InPhyNet.jl"/><meta property="twitter:title" content="Choosing your subsets · InPhyNet.jl"/><meta name="description" content="Documentation for InPhyNet.jl."/><meta property="og:description" content="Documentation for InPhyNet.jl."/><meta property="twitter:description" content="Documentation for InPhyNet.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="InPhyNet.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">InPhyNet.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation/">Installation</a></li><li><span class="tocitem">Walkthrough</span><ul><li><a class="tocitem" href="../introduction/">Introduction</a></li><li><a class="tocitem" href="../d-matrix/">Estimate a pairwise distance matrix</a></li><li class="is-active"><a class="tocitem" href>Choosing your subsets</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Using-TINNiK"><span>Using TINNiK</span></a></li></ul></li><li><a class="tocitem" href="../constraints/">Inferring constraint networks</a></li><li><a class="tocitem" href="../full_net/">Constructing the full network</a></li></ul></li><li><a class="tocitem" href="../../documentation/">Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Walkthrough</a></li><li class="is-active"><a href>Choosing your subsets</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Choosing your subsets</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NathanKolbow/InPhyNet.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NathanKolbow/InPhyNet.jl/blob/main/docs/src/walkthrough/subsets.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Choosing-your-subsets"><a class="docs-heading-anchor" href="#Choosing-your-subsets">Choosing your subsets</a><a id="Choosing-your-subsets-1"></a><a class="docs-heading-anchor-permalink" href="#Choosing-your-subsets" title="Permalink"></a></h1><p>For thorough analyses, careful subset selection is important. InPhyNet cannot infer instances of reticulate evolution between its input networks, so several taxa from clades where reticulate evolution is likely to have occurred should appear together in at least one subset. To this end, we recommend first performing analyses with software like <a href="https://cran.r-project.org/web/packages/MSCquartets/vignettes/TINNIK.html">TINNiK</a> to identify these areas. We provide an example of how this could be done below.</p><p>Here, we take a naive approach and simply perform <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC6705769/#:~:text=The%20clustering%20used%20in,each%20subset.&amp;text=from%20the%20previous%20iteration%29%2C,each%20subset.&amp;text=the%20two%20parts%20have,each%20subset.&amp;text=each%20subtree%20until%20there,each%20subset.">centroid edge decomposition</a> on a species tree inferred by InPhyNet without any constraint networks (this is equivalent to Neighbor-Joining). Centroid edge decomposition is a recursive process that splits a &quot;guide tree&quot; in half at a single edge such that the two halves are of equal size. Then, this process is done recursively on the resulting trees until each subtree contains at most some predefined number of taxa.</p><p>This requires us to specify a maximum subset size–for this walkthrough we will use <span>$8$</span>. In practice we recommend that you use the highest number such that you can still infer networks in a reasonable amount of time with your preferred network inference software. We use <span>$8$</span> here so that all of the walkthrough can be completed quickly.</p><p>Additionally, we specify a minimum subset size of <span>$5$</span> because that is the smallest set of data that SNaQ can infer a network on.</p><pre><code class="language-julia hljs">nj_tre = inphynet(D, namelist)
subsets = centroid_edge_decomposition(nj_tre, 5, 8)</code></pre><h1 id="Using-TINNiK"><a class="docs-heading-anchor" href="#Using-TINNiK">Using TINNiK</a><a id="Using-TINNiK-1"></a><a class="docs-heading-anchor-permalink" href="#Using-TINNiK" title="Permalink"></a></h1><p>TINNiK is implemented in the <a href="https://cran.r-project.org/web/packages/MSCquartets/vignettes/TINNIK.html">MSCquartets</a> package in <a href="https://www.r-project.org/about.html">R</a>, so we need to save our estimated gene trees to a file so that they can be opened in R.</p><pre><code class="language-julia hljs"># In Julia
writemultinewick(est_gts, &quot;example_gts.tre&quot;)</code></pre><p>The runtime of TINNIK quickly climbs with the number of taxa being evaluated. With our 51 taxa example it may take several minutes for results to come back. In the case of many more taxa it could take several hours, days, or even longer. In such cases, TINNIK may not be the preferred tool for conducting this portion of the analyses. If it is still preferred, though, it may be necessary to break the set of all taxa into smaller subsets each of which has its own tree of blobs inferred.</p><pre><code class="language-R hljs"># In R
library(MSCquartets)

gts &lt;- read.tree(file = &quot;example_gts.tre&quot;)
results &lt;- TINNIK(gts, alpha=0.05, beta=0.95, plot=FALSE)
tob &lt;- results$ToB

plot(tob)</code></pre><p><img src="../first-tob.png" alt="First Tree of Blobs"/></p><p>When using TINNIK, it is important to explore multiple values of <span>$\alpha$</span> and <span>$\beta$</span> before assessing any results. Fortunately, evaluating subsequent values for <span>$\alpha$</span> and <span>$\beta$</span> is very fast because we can re-use data from the original analysis.</p><blockquote><p>[!NOTE]</p></blockquote><p>More information on <span>$\alpha$</span> and <span>$\beta$</span> parameters, including best practices recommended by the authors of TINNIK, can be found in <a href="https://cran.r-project.org/web/packages/MSCquartets/vignettes/TINNIK.html">this TINNIK vignette</a>, which we highly recommend reading before using TINNIK.</p><pre><code class="language-R hljs">results2 &lt;- TINNIK(results$pTable, alpha=0.01, beta=0.99, plot=FALSE)
tob2 &lt;- results2$ToB

plot(tob2)</code></pre><p><img src="../second-tob.png" alt="Second Tree of Blobs"/></p><p>From these results, we would ideally split these taxa three subsets:</p><ol><li>Containing the taxa with tree-like relationships at the top of the figure along with the outgroup</li><li>The first large block of taxa represented by a multifurcation (t48, t46, t45, ..., t30, t26)</li><li>The second such large block of taxa (t4, t23, t22, ..., t17, t16, t1)</li></ol><p>For this walkthrough, such subsets would lead to very long inference times, so we will forgo this step and instead utilize the subsets generated above.</p><blockquote><p>[!NOTE]</p></blockquote><p>In practice, if such subsets are too large to be feasible with your preferred method of network inference, then concessions must be made in some manner, likely either by splitting these blocks into smaller subsets or by utilizing a faster but less accurate method of network inference.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../d-matrix/">« Estimate a pairwise distance matrix</a><a class="docs-footer-nextpage" href="../constraints/">Inferring constraint networks »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Thursday 5 June 2025 19:59">Thursday 5 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
