using Revise
using InPhyNet, PhyloNetworks, CSV, DataFrames

constraints = [readTopology(c) for c in split("(((t97:0.2557046926,t65:0.2557046926):0.847984926,(t62:1.02275023,((((t44:0.5291273609,t22:0.08975555805):0.4393718029,t11:0.08975555805):0.4926778126,t29:0.7993204588):0.2224847148,(t79:0.3470935161,t43:0.3470935161):0.4522269427):0.0009450561871):0.08093938888):0.01954471373,t95:1.123234332);
((t59:1.230378163,((((t93:0.0)#H184:0.002597308042::0.6595127518,t100:0.2528870435):0.8337574789,(((t32:0.6343892529,(t41:0.1936019256,t99:0.1936019256):0.0):0.0)#H199:0.01536257621::0.6414549323,t61:0.6497518291):0.4368926933):0.4475207657,(t67:0.8699712206,(t38:0.2502897355,#H184:0.0::0.3404872482):0.6196814851):0.3604069423):0.3037871252):0.008355572748,(#H199:0.3385671144::0.3585450677,((t42:0.4774611572,t45:0.4774611572):0.3247465008,t53:0.8022076579):0.1707487094):0.5695644936);
((t20:1.53018941,(((t6:0.2778928303,t24:0.2778928303):0.6596607576,t5:0.9375535879):1.223318972,(t89:1.378356854,(t94:1.031080738,((t84:1.147230895,(t98:0.8572687613,((t73:0.2558253267,t36:0.2558253267):0.6014434347)#H185:0.0::0.5384321135):0.2899621333):0.2112088819,(t51:0.8572687613,#H185:0.0::0.4615678865):0.1738119768):0.3273590384):0.01991707742):0.1518325565):0.6306831493):0.04949860522,t83:2.2103711646);
((((t80:0.1633037316,((t87:0.0)#H193:0.5670300078::0.5006490054,(t78:0.6031487072,t21:0.5670300078):0.03611869942):0.578779314):0.05979283745,((t92:0.04172250775,t57:0.04172250775):0.7601533752,t74:0.7420830455):0.3266155698):0.2151265432,(t85:0.9133649096,(#H193:0.0::0.4993509946,t82:0.1633037316):0.0):0.171281864):1.100359381,t71:2.228850834);
(((t8:0.2855192312,t55:0.2855192312):2.279091952,(#H132:1.753998423::0.3566437332,((t56:1.729688189,((t16:0.2550133307,t88:0.0):0.0)#H132:1.474674858::0.6433562668):0.1133289848,t17:1.843017174):0.1659945797):0.5555994294):0.2436294849,(t31:0.4552512165,(((t72:0.01140586483,t35:0.01140586483):0.5055496654,t77:0.5169555303):0.05806272994,t33:0.4552512165):0.1197670437):2.233222407);
(OUTGROUP:1.0,((t75:0.4128770033,t76:0.4128770033):3.101018567,(((t91:0.4880553746,(t63:0.1946532756,t39:0.1946532756):0.293402099):0.1898268116,t54:0.6778821861):0.5157597027,(t52:0.7948130487,((t46:0.2327903681,t14:0.2327903681):0.6522652769,t86:0.7948130487):0.09024259624):0.3085862439):2.32025368165));
(((((t9:0.1809018798,t50:0.1809018798):0.3340415311,(t90:0.3316680825,t64:0.3316680825):0.1832753284):0.3106754845,(t4:0.3844092102,t10:0.3844092102):0.4412096852):0.2196010541,t19:1.0452199493999998):0.7705096141,(t68:0.353830736,t25:0.353830736):1.461898828);
((t49:0.5318338398,((t28:0.1966959209,t81:0.1966959209):0.2492500112,(t2:0.4459459321,(t1:1.988433916,t23:1.988433916):0.4622589683):0.08588790771):1.918859044):0.04825223502,(t69:0.948455845,((t27:0.4155393478,t47:0.4155393478):1.298665856,t34:0.9484558449):0.7657493591):0.7847399151);
((((t30:0.6685240361,t58:0.4615088345):0.2070152016,t48:0.33872361323):0.1227852213,t12:0.3387236132):0.5440009279,(t37:0.6877177302,((t18:0.1690447473,t70:0.1690447473):0.9851771565,(t60:0.55215502,t13:0.55215502):0.1355627102):0.4665041736):0.05830306016);
((#H220:1.1780150463::0.4505535537,#H202:0.65955066422::0.3563210551):2.000110814,(t3:1.679807464,(((t96:0.5529742998,((t7:0.03450991773,(t40:0.03450991773)#H220:0.0::0.5494464463):0.1930919393,(t26:0.2658302715,t15:0.2276018571):0.03822841444):1.084940813):0.7977967844,t66:0.0):0.0)#H202:0.3290363802::0.6436789449):1.532828313);", "\n")]

truenet = readTopology("((((((((((t2:0.4459459321,(t28:0.1966959209,t81:0.1966959209):0.2492500112):0.08588790771,t49:0.5318338398):1.918859044,(t1:1.988433916,t23:1.988433916):0.4622589683):0.04825223502,(((t27:0.4155393478,t47:0.4155393478):1.298665856,((t34:0.7299147181,#H171:0.0::0.4781301892):0.2185411268,t69:0.948455845):0.7657493591):0.669992739,((((t19:0.7299147181)#H171:0.3153052313::0.5218698108,(((t9:0.1809018798,t50:0.1809018798):0.3340415311,((t90:0.3316680825,t64:0.3316680825):0.1832753284)#H209:0.0::0.5868628641):0.3106754845,(t4:0.3844092102,t10:0.3844092102):0.4412096852):0.2196010541):0.7705096141,(t68:0.353830736,t25:0.353830736):1.461898828):0.0924294936,((((t97:0.2557046926,t65:0.2557046926):0.847984926,(t62:1.02275023,((t29:0.7993204588,(t79:0.3470935161,t43:0.3470935161):0.4522269427):0.2224847148,((t11:0.08975555805,t22:0.08975555805):0.4393718029,t44:0.5291273609):0.4926778126):0.0009450561871):0.08093938888):0.01954471373,t95:1.123234332):0.3125434607,#H119:0.0::0.4728518898):0.4723812641):0.4760388858):0.1147471761):0.08219702261,(((t20:1.53018941,(t89:1.378356854,((t94:1.031080738,(t51:0.8572687613,#H185:0.0::0.4615678865):0.1738119768):0.3273590384,(t84:1.147230895,(t98:0.8572687613,(((t73:0.2558253267,t36:0.2558253267):0.2591180842,#H209:0.0::0.4131371359):0.3423253505)#H185:0.0::0.5384321135):0.2899621333):0.2112088819):0.01991707742):0.1518325565):0.6306831493,((t6:0.2778928303,t24:0.2778928303):0.6596607576,t5:0.9375535879):1.223318972):0.04949860522,(t83:1.660609344,(((((t93:0.2502897355,#H184:0.0::0.3404872482):0.002597308042,t100:0.2528870435):0.8337574789,(((t41:0.1936019256,t99:0.1936019256):0.4407873273)#H199:0.01536257621::0.6414549323,t61:0.6497518291):0.4368926933):0.4475207657,(t59:1.230378163,(t67:0.8699712206,(t38:0.2502897355)#H184:0.6196814851::0.6595127518):0.3604069423):0.3037871252):0.008355572748,((t32:0.6343892529,#H199:0.0::0.3585450677):0.3385671144,((t42:0.4774611572,t45:0.4774611572):0.3247465008,t53:0.8022076579):0.1707487094):0.5695644936):0.1180884834):0.5497618206):0.3707709768):0.3900583021,(((t91:0.4880553746,(t63:0.1946532756,t39:0.1946532756):0.293402099):0.1898268116,t54:0.6778821861):0.5157597027,((t46:0.2327903681,t14:0.2327903681):0.6522652769,(t52:0.7948130487,t86:0.7948130487):0.09024259624):0.3085862439):1.777558555):0.09905080695,(((t8:0.2855192312,t55:0.2855192312):2.279091952,(#H132:1.753998423::0.3566437332,((t56:1.729688189,(t16:0.2550133307,(t88:0.2550133307)#H132:0.0::0.6433562668):1.474674858):0.1133289848,t17:1.843017174):0.1659945797):0.5555994294):0.2436294849,(((((t72:0.01140586483,t35:0.01140586483):0.5055496654,t77:0.5169555303):0.05806272994,(t31:0.4552512165,t33:0.4552512165):0.1197670437):0.8607595329)#H119:1.087181161::0.5271481102,((((t74:0.7420830455,(((t87:0.5670300078,t21:0.5670300078):0.03611869942,t78:0.6031487072):0.1389343383)#H193:0.0::0.5006490054):0.171281864,t85:0.9133649096):0.2151265432,((t92:0.04172250775,t57:0.04172250775):0.7601533752,((t82:0.1633037316,t80:0.1633037316):0.578779314,#H193:0.0::0.4993509946):0.05979283745):0.3266155698):1.100359381,t71:2.228850834):0.2941081208):0.2852817131):0.2620105831):0.4436443197,(t75:0.4128770033,t76:0.4128770033):3.101018567):0.3835321851,(((t30:0.6685240361,(t58:0.4615088345,((t48:0.03450991773,#H220:0.0::0.4505535537):0.3042136955,t12:0.3387236132):0.1227852213):0.2070152016):0.5440009279,(((t60:0.55215502,t13:0.55215502):0.1355627102,t37:0.6877177302):0.4665041736,(#H202:0.03418436306::0.3563210551,(t18:0.1690447473,t70:0.1690447473):0.4181139155):0.567063241):0.05830306016):2.000110814,(t3:1.679807464,((t96:0.5529742998,(t66:0.5529742998)#H202:0.0::0.6436789449):0.7977967844,((t15:0.2276018571,(t7:0.03450991773,(t40:0.03450991773)#H220:0.0::0.5494464463):0.1930919393):0.03822841444,t26:0.2658302715):1.084940813):0.3290363802):1.532828313):0.6847919778),OUTGROUP:1.0);")

_, namelist = majorinternodedistance(truenet)
D = Matrix(CSV.read("/mnt/home/nkolbow/repos/network-merging/dmat1.csv", DataFrame))
mnet = netnj(D, constraints, namelist)

using PhyloPlots
PhyloPlots.plot(constraints[1])