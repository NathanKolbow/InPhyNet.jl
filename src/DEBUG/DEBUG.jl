using Revise
include("../../simulations/pipelines.jl")
include("../../simulations/robustness-fxns.jl")

constraints = [readTopology(c) for c in split("(t50:1.065816395,((((t59:0.4401938892,(t100:0.4401938892)#H346:0.0::0.5673152844):0.1642576472,t167:0.6044515365):0.05939996684,#H346:0.2236576141::0.4326847156):0.3726586529,(t102:0.8438210018,((t9:0.3074689872,t16:0.3074689872):0.1414980443,(((t179:0.07493198889,t112:0.07493198889):0.7188317164,(t182:0.1673807329,(t156:0.01803187191,t11:0.01803187191):0.1493488609):0.6263829725):0.01020926885,t137:0.4489670315):0.3550059427):0.0398480276):0.1926891545):0.02930623918);
(((t66:1.22843367,(t1:1.22843367,(((t153:0.3943990019,((t181:0.3464022106,(t57:0.06700019217)#H406:0.0::0.6379173507):0.2794020184,t48:0.06700019217):0.04799679137):0.57185348,(t148:0.005178525761,t21:0.005178525761):0.2611394813):0.6999344749,t12:0.266318007):0.09961798072):0.35783585324):0.5203990603,((t198:0.364456229,(t159:0.0308613732,t185:0.0308613732):0.3335948558):0.09613094211,t42:0.4605871711):0.6052832916):0.5023945133,#H406:2.0216638441400003::0.3620826493);
(((t70:0.07959668061,t139:0.07959668061):1.308277326,(((t158:0.2896935605,t27:0.2896935605):0.1266518944,(t83:0.4163454549)#H384:0.0::0.508575747):1.334743525,(((t31:0.05987355911,t115:0.05987355911):0.5468720566,t197:0.6067456157):0.06455691998,(t94:0.1175929147,t142:0.1175929147):0.553709621):0.7165714708):0.3632149736):1.6373581871999998,#H384:2.9721017128600002::0.491424253);
((t99:0.765447255,(t141:1.236778341,t154:0.765447255):0.4713310858):0.8518856954,(((((t4:0.09328701952,t114:0.09328701952):0.06484842586,t56:0.1581354454):0.2527872864,t81:0.4109227318):0.3950947355,(t113:0.4145700202,t84:0.4145700202):0.391447447):0.01312232944,(t136:0.4272915113,t68:0.4272915113):0.3918482854):1.2695242397000002);
((t171:0.4372869679,(((t170:0.6717606122,(t177:0.08668881589,(t107:0.08668881589,(t140:0.6917857805,((t28:0.586609408,t53:0.02302091031):0.0)#H359:0.1051763725::0.6040427818):1.281097589):0.5850717963):1.324103107):0.02298034989,t19:0.4372869679):1.535596401,t25:2.372242919):0.3763791995):1.04648656587,#H359:2.8551409870900004::0.3959572182);
((t64:0.657448132,(((((t51:0.3270265362,t22:0.3270265362):0.09135352178,(t36:0.659578728,(t26:0.3358620481,t125:0.3358620481):0.08251800986):0.24119867):0.0)#H221:2.2848127091::0.5142045752,t104:0.9162621101):2.036829447,(t54:0.1142709805,((t17:0.009744097958,t146:0.009744097958):0.03991684098,t147:0.04966093894):0.06461004153):0.5431771515):0.2588139781):0.46563792697,#H221:2.75045063559::0.4857954248);
((((((t80:0.3389190332,t122:0.5207826248):0.1818635916,t196:0.3389190332):0.5353440399,(((t130:0.4380692694,t24:0.4380692694):0.121723003,t149:0.5597922724):0.4963343923,((t129:0.2902492506,(t133:0.501994511)#H375:0.0::0.6100175235):0.2117452603,t5:0.2902492506):0.6145507571):0.06041860338):0.02072100088,t55:1.137266269):0.207457579,(t43:0.3234025165,t47:0.3234025165):1.021321331):2.0740056366,#H375:2.9167349738300006::0.3899824765);
(((t87:0.03965287946,(((((t119:0.1378920617,(t180:0.1378920617)#H402:0.0::0.515942055):0.4312038687,(t71:0.5424571538,t101:0.54245715386):0.0266387766):0.3790571346,t176:0.8830992423999999):0.06505382263,(t199:1.061385994,t144:0.8830992424):0.1132329292):0.2522659205,t188:0.03965287946):1.273999035):2.074795253,((t23:0.1277341938,t75:0.1277341938):0.4880812553,t85:0.6158154492):2.772631718):0.03028231706,(t128:0.2703424324,#H402:0.1324503707::0.484057945):3.148387052);
((t190:0.5695597866,(t18:0.2077117903,(t49:0.03487903482,t30:0.03487903482):0.1728327555):0.3618479963):0.3831605618,((t103:0.07971524451,t174:0.07971524451):0.2872828143,((t162:0.1466116774,(((t168:0.5119908303,t161:0.4750642707):0.03692655963,t92:0.02778368517):0.1188279922,t127:0.02778368517):0.3284525933):0.1265563235,(t132:0.03482906638,t121:0.03482906638):0.3321689924):0.271549095):0.3141731946);
((((t163:0.5927250069,t40:0.2824556079):0.310269399,t44:0.2824556079):0.1967462222,t78:0.7894712291):0.7067193515,((((t88:0.4083777834,t34:0.1762601002):0.2321176832,t15:0.1762601002):0.2823448365,(t93:0.3425177513,t172:0.3425177513):0.3482048687):0.1195341706,(t86:0.04573914181,t173:0.04573914181):0.7645176488):0.6859337901);
(((((t32:1.617272753,(t41:0.3203738219,(t134:0.2122831734,(t126:0.1198537598,t98:0.1198537598):0.0924294136):0.1080906485):0.2059381845):1.2629584623999999,t61:0.3788012891):0.1475107172,t169:0.3788012891):0.1719977157,(((t131:0.2449910394,t82:0.2449910394):0.06056713965,t123:1.046773297):0.7412151181,t69:0.3055581791):0.5704994557):0.1918269328,(t151:0.09400394207,t58:0.09400394207):1.88709345954);
((((t192:0.1344005791,t67:0.1344005791):0.393357094,t10:0.527757673):0.01185580203,t2:0.5396134751):0.3170783518,(t186:0.7563733716,(t191:0.353650481,(t95:0.3012035188,((t37:0.3886763867,t35:0.3886763867):0.1328735774,t143:0.3012035188):0.05244696215):0.1678994832):0.2348234075):0.1003184553);
((t106:0.4478729303,t46:0.4478729303):1.332230303,(((t187:0.05043092308,(((t157:0.003560433326,t189:0.003560433326):0.04039419486,t108:0.03810154837):1.006221471,t138:0.04395462818):0.0123293747):0.9997451763,t76:0.03810154837):0.3448301694,(((t90:0.2550018509,t8:0.2550018509):0.4042413592,((t116:0.2162186271,t195:0.2162186271):0.3723436707,t52:0.5885622979):0.07068091226):0.2562312019,t194:0.915474412):0.4795318568):0.3850969647);
(((((t29:0.9654176458,t111:0.9654176458):0.3617186381,((t14:1.198362971,t165:1.198362971):0.5241761397,t79:1.327136284):0.3954028265):1.885819296,((t62:1.421280027,(t178:0.1916509686,(t160:0.2901103428,t109:0.1916509686):0.09845937416):1.131169684):0.8702765572,(t150:3.152522048,((t175:0.2237423807,t166:0.2237423807):0.6616378601,(t73:0.8853802408)#H314:0.0::0.6764977236):1.406176343):0.860965464):0.4558363587):0.453183183,#H314:3.1761613486999996::0.3235022764),OUTGROUP:1.0);
((t105:0.7312305917,(t118:0.0899590249,((t65:0.3754703422,t6:0.0899590249):0.2764938245,(t72:0.3789883045,t63:0.3664528494):0.003517962282):0.009017492806):0.3522422872):0.1100936882,(t91:0.1865779469,(t120:0.1865779469,t20:0.6500949094):0.4635169625):0.1912293706);
(#H410:1.286771233::0.431375257,(((((t124:0.11284765,t135:0.11284765):0.07863373568,(t96:0.1914813857)#H410:0.0::0.568624743):0.01192009017,(t193:0.2034014759,t74:0.4157713561):0.2123698802):0.5982659729,(t39:0.3464064493,t183:0.3464064493):1.070191005):0.4025601252,t164:1.014037329):0.06165516418);
(#H416:3.8128730276900002::0.3803517079,((t33:0.09656857809,(((t45:0.02280305123,t184:0.02280305123):0.4961303104,(t145:0.1417957643,(t60:0.1417957643)#H416:0.0::0.6196482921):0.3771375973):0.3708655493,t3:0.09656857809):0.7932303329):0.2157795369,t13:1.105578448):2.84909034425);
((t110:1.988260341,(t152:0.8255739343,((t117:0.03879708938,t77:0.03879708938):0.1951330776,(t38:0.1124930579,t97:0.1124930579):0.1214371091):0.5916437674):1.162686407):0.01225037685,(t7:0.57696825,(t200:0.57696825,(t155:1.56006177,t89:0.7148080902):0.8452536799):0.1378398401):0.4404489481);", "\n")]

truenet = readTopology("(((((t14:1.198362971,t165:1.198362971):0.5241761397,((t29:0.9654176458,t111:0.9654176458):0.3617186381,t79:1.327136284):0.3954028265):1.885819296,(t150:3.152522048,(((t175:0.2237423807,t166:0.2237423807):0.6616378601,(t73:0.8853802408)#H314:0.0::0.6764977236):1.406176343,(t62:1.421280027,(t160:0.2901103428,(t178:0.1916509686,t109:0.1916509686):0.09845937416):1.131169684):0.8702765572):0.860965464):0.4558363587):0.453183183,(((((((t151:0.09400394207,t58:0.09400394207):0.09747744364,#H410:0.0::0.431375257):1.286771233,(((t105:0.7312305917,((t65:0.3754703422,((t118:0.0899590249,t6:0.0899590249):0.2764938245,t63:0.3664528494):0.009017492806):0.003517962282,t72:0.3789883045):0.3522422872):0.1100936882,(t20:0.6500949094,(t120:0.1865779469,t91:0.1865779469):0.4635169625):0.1912293706):0.59623104,(((t74:0.4157713561,(t193:0.2034014759,((t124:0.11284765,t135:0.11284765):0.07863373568,(t96:0.1914813857)#H410:0.0::0.568624743):0.01192009017):0.2123698802):0.5982659729,t164:1.014037329):0.4025601252,(t39:0.3464064493,t183:0.3464064493):1.070191005):0.02095786574):0.04069729844):0.5028447829,(((((t131:0.2449910394,t82:0.2449910394):0.06056713965,t69:0.3055581791):0.7412151181,t123:1.046773297):0.5704994557,t32:1.617272753):0.1719977157,(((t41:0.3203738219,(t134:0.2122831734,(t126:0.1198537598,t98:0.1198537598):0.0924294136):0.1080906485):0.2059381845,(t169:0.3788012891,t61:0.3788012891):0.1475107172):1.035796448,((((t44:0.2824556079,t40:0.2824556079):0.310269399,t163:0.5927250069):0.1967462222,t78:0.7894712291):0.7067193515,(((((t15:0.1762601002,t34:0.1762601002):0.2321176832,t88:0.4083777834):0.2823448365,(t93:0.3425177513,t172:0.3425177513):0.3482048687):0.1195341706,(t86:0.04573914181,t173:0.04573914181):0.7645176488):0.451431639,((t190:0.5695597866,(t18:0.2077117903,(t49:0.03487903482,t30:0.03487903482):0.1728327555):0.3618479963):0.3831605618,(((t132:0.03482906638,t121:0.03482906638):0.3321689924,(t103:0.07971524451,t174:0.07971524451):0.2872828143):0.271549095,(((t161:0.1417957643,#H416:0.0::0.3803517079):0.3332685064,(t162:0.1466116774,(t127:0.02778368517,t92:0.02778368517):0.1188279922):0.3284525933):0.03692655963,t168:0.5119908303):0.1265563235):0.3141731946):0.3089680811):0.2345021511):0.06591787346):0.2271620144):0.1918269328):0.3984075877,((t106:0.4478729303,t46:0.4478729303):1.332230303,((((t76:0.03810154837,t108:0.03810154837):0.0123293747,t187:0.05043092308):0.9997451763,((t157:0.003560433326,t189:0.003560433326):0.04039419486,t138:0.04395462818):1.006221471):0.3448301694,(((((t192:0.1344005791,t67:0.1344005791):0.393357094,t10:0.527757673):0.01185580203,t2:0.5396134751):0.3170783518,(t186:0.7563733716,((t37:0.3886763867,t35:0.3886763867):0.1328735774,(t191:0.353650481,(t95:0.3012035188,t143:0.3012035188):0.05244696215):0.1678994832):0.2348234075):0.1003184553):0.2041955895,(((t90:0.2550018509,t8:0.2550018509):0.4042413592,((t116:0.2162186271,t195:0.2162186271):0.3723436707,t52:0.5885622979):0.07068091226):0.2562312019,(t194:0.8853802408,#H314:0.0::0.3235022764):0.0300941712):0.1454130044):0.3341188524):0.3850969647):0.5994017556):1.256073812,((((t128:0.2703424324,#H402:0.1324503707::0.484057945):1.309188594,(((((t129:0.2902492506,t5:0.2902492506):0.2117452603,(t133:0.501994511)#H375:0.0::0.6100175235):0.6145507571,(((t130:0.4380692694,t24:0.4380692694):0.121723003,t149:0.5597922724):0.4963343923,((t80:0.3389190332,t196:0.3389190332):0.1818635916,t122:0.5207826248):0.5353440399):0.06041860338):0.02072100088,t55:1.137266269):0.207457579,(t43:0.3234025165,t47:0.3234025165):1.021321331):0.2348071786):1.455688659,(((t25:2.372242919,(((t171:0.4372869679,t19:0.4372869679):1.535596401,(t140:0.6917857805,(t28:0.586609408,(t53:0.5635884977)#H359:0.02302091031::0.6040427818):0.1051763725):1.281097589):0.02298034989,((t177:0.08668881589,t107:0.08668881589):0.5850717963,t170:0.6717606122):1.324103107):0.3763791995):0.2511334608,((((t51:0.3270265362,t22:0.3270265362):0.09135352178,(t26:0.3358620481,t125:0.3358620481):0.08251800986):0.24119867,t36:0.659578728):0.008700120661)#H221:1.955097531::0.5142045752):0.3297151781,((t64:0.657448132,(t54:0.1142709805,((t17:0.009744097958,t146:0.009744097958):0.03991684098,t147:0.04966093894):0.06461004153):0.5431771515):0.2588139781,t104:0.9162621101):2.036829447):0.08212812797):0.383509799,((((((((t12:0.266318007,(t148:0.005178525761,t21:0.005178525761):0.2611394813):0.6999344749,(t153:0.3943990019,((t48:0.06700019217,(t57:0.06700019217)#H406:0.0::0.6379173507):0.2794020184,t181:0.3464022106):0.04799679137):0.57185348):0.09961798072,((t198:0.364456229,(t159:0.0308613732,t185:0.0308613732):0.3335948558):0.09613094211,t42:0.4605871711):0.6052832916):0.5203990603,((t1:1.22843367,t66:1.22843367):0.05018191214,(t50:1.065816395,((((t59:0.4401938892,(t100:0.4401938892)#H346:0.0::0.5673152844):0.1642576472,t167:0.6044515365):0.05939996684,#H346:0.2236576141::0.4326847156):0.3726586529,(t102:0.8438210018,((((t182:0.1673807329,(t156:0.01803187191,t11:0.01803187191):0.1493488609):0.5008981158,#H221:0.0::0.4857954248):0.1254848567,(t179:0.07493198889,t112:0.07493198889):0.7188317164):0.01020926885,((t9:0.3074689872,t16:0.3074689872):0.1414980443,t137:0.4489670315):0.3550059427):0.0398480276):0.1926891545):0.02930623918):0.2127991864):0.3076539411):0.2811050805,((t99:0.765447255,t154:0.765447255):0.4713310858,t141:1.236778341):0.6305962626):0.2212894328,((((t158:0.2896935605,t27:0.2896935605):0.1266518944,(t83:0.4163454549)#H384:0.0::0.508575747):1.334743525,((((t31:0.05987355911,t115:0.05987355911):0.5468720566,t197:0.6067456157):0.06455691998,(t94:0.1175929147,t142:0.1175929147):0.553709621):0.7165714708,(t70:0.07959668061,t139:0.07959668061):1.308277326):0.3632149736):0.2057412006,(((((t4:0.09328701952,t114:0.09328701952):0.06484842586,t56:0.1581354454):0.2527872864,t81:0.4109227318):0.3950947355,(t113:0.4145700202,(t84:0.2156969105,#H406:0.1486967183::0.3620826493):0.1988731097):0.391447447):0.01312232944,(t136:0.4272915113,t68:0.4272915113):0.3918482854):1.137690384):0.1318338557):0.1569108109,((t23:0.1277341938,t75:0.1277341938):0.4880812553,t85:0.6158154492):1.629759398):1.14287232,((t87:0.03965287946,t188:0.03965287946):1.273999035,(t199:1.061385994,(((t119:0.1378920617,(t180:0.1378920617)#H402:0.0::0.515942055):0.4312038687,(((t101:0.4163454549,#H384:0.0::0.491424253):0.08564905609,#H375:0.0::0.3899824765):0.04046264287,t71:0.5424571538):0.0266387766):0.3790571346,((t176:0.5635884977,#H359:0.0::0.3959572182):0.3195107447,t144:0.8830992424):0.06505382263):0.1132329292):0.2522659205):2.074795253):0.03028231706):0.2168493171):0.319089991,((t110:1.988260341,((t152:0.8255739343,((t117:0.03879708938,t77:0.03879708938):0.1951330776,(t38:0.1124930579,t97:0.1124930579):0.1214371091):0.5916437674):0.9243457807,(((t33:0.09656857809,t3:0.09656857809):0.7932303329,((t45:0.02280305123,t184:0.02280305123):0.4961303104,(t145:0.1417957643,(t60:0.1417957643)#H416:0.0::0.6196482921):0.3771375973):0.3708655493):0.2157795369,t13:1.105578448):0.6443412671):0.2383406263):0.01225037685,(((t7:0.57696825,t200:0.57696825):0.1378398401,t89:0.7148080902):0.8452536799,t155:1.56006177):0.4404489481):1.954158074):0.1068727974),OUTGROUP:1.0);")

D, namelist = majorinternodedistance(truenet)
mnet = netnj(D, constraints, namelist)