using Revise
using InPhyNet, PhyloNetworks, CSV, DataFrames

constraints = [readTopology(c) for c in split("((((t20:0.1807363108,t21:0.1807363108):1.050623328,(t5:0.7913149366,(t4:0.7913149366,(t9:0.524283538,(t8:0.524283538,t7:0.5848642878):0.06058074975):0.28860859):0.4041517787):0.3219938375):0.03589292339,(t24:0.1108432217,t25:0.1108432217):0.762629656):0.1721531644,((t3:0.9346206783,((t17:0.2674653773,t10:0.3739420628):0.1064766854,(t18:0.2448870208,t19:0.2448870208):0.0225783565):0.5606786156):0.03836623136,t2:0.9729869097):0.4305258934);
((t6:0.6071416329,(t11:0.3694966848,t12:0.3694966848):0.2376449481):2.774214019,(((t22:0.1268704706,t23:0.1268704706):0.5505418761,(t15:0.2756767114,t16:0.2756767114):0.4017356353):0.30578464,(t1:3.214410362,(t13:0.3330370665,t14:0.3330370665):0.6501599202):2.2312133756000003):0.1669452892);
((((((t39:0.2763184379,t40:0.2763184379):0.1549139968,(t37:0.4223043805,t38:0.4223043805):0.008928054238):0.8376894673,(((t49:0.07175994129,t50:0.07175994129):1.083935702)#H2:0.0::0.6449982559,t29:1.155695644):0.07159530839):0.04163095003,((t31:0.9235384342,t32:0.9235384342):0.139877826,(t33:0.7028921477,(t30:1.035603855,t34:0.7028921477):0.3327117074):0.0):0.1638746918):0.0)#H1:0.7771754997::0.5767319882,((t28:1.271487228,#H1:0.2080709674::0.4232680118):0.4503611998,#H2:0.5661527838::0.3550017441):0.3242489743);
(OUTGROUP:1.0,((t27:1.8385533,((t42:0.2345680266,(t41:0.2345680266,t35:0.5338204586):0.2992524319):0.4293367349,(t36:0.4617268848,(t44:0.1636737383,(t43:0.2132251132,t45:0.1636737383):0.04955137494):0.2485017716):0.5014303087):0.8753961064):0.519320597,((t48:0.0831454838,(t46:0.08436744959,t47:0.0831454838):0.00122196579):3.509631654,t26:2.357873897):1.236125207):0.5341385824770393);", "\n")]

truenet = readTopology("((((t6:0.6071416329,(t11:0.3694966848,t12:0.3694966848):0.2376449481):2.774214019,(t1:3.214410362,(((t13:0.3330370665,t14:0.3330370665):0.6501599202,((t22:0.1268704706,t23:0.1268704706):0.5505418761,(t15:0.2756767114,t16:0.2756767114):0.4017356353):0.30578464):0.8886437536,(((((t7:0.5848642878,(t8:0.524283538,t9:0.524283538):0.06058074975):0.28860859,(t24:0.1108432217,t25:0.1108432217):0.762629656):0.3219938375,(t4:0.7913149366,t5:0.7913149366):0.4041517787):0.03589292339,(t20:0.1807363108,t21:0.1807363108):1.050623328):0.1721531644,((t3:0.9346206783,((t17:0.2674653773,(t18:0.2448870208,t19:0.2448870208):0.0225783565):0.1064766854,t10:0.3739420628):0.5606786156):0.03836623136,t2:0.9729869097):0.4305258934):0.4683279373):1.342569622):0.1669452892):0.01909594913,(((t27:1.8385533,((t35:0.5338204586,(t41:0.2345680266,t42:0.2345680266):0.2992524319):0.4293367349,(t36:0.4617268848,(t43:0.2132251132,(t44:0.1636737383,t45:0.1636737383):0.04955137494):0.2485017716):0.5014303087):0.8753961064):0.519320597,t26:2.357873897):1.236125207,(((t47:0.0831454838,t48:0.0831454838):0.00122196579,t46:0.08436744959):1.978833274,((((t39:0.2763184379,t40:0.2763184379):0.1549139968,(t37:0.4223043805,t38:0.4223043805):0.008928054238):0.8376894673,(((((t33:0.7028921477,t34:0.7028921477):0.3327117074,t30:1.035603855):0.02781240507)#H1:0.0::0.5767319882,(t31:0.9235384342,t32:0.9235384342):0.139877826):0.1638746918,(((t49:0.07175994129,t50:0.07175994129):1.083935702)#H2:0.0::0.6449982559,t29:1.155695644):0.07159530839):0.04163095003):0.7771754997,((t28:1.271487228,#H1:0.2080709674::0.4232680118):0.4503611998,#H2:0.5661527838::0.3550017441):0.3242489743):0.01710332211):1.53079838):0.01909594913):0.5150426333470393,OUTGROUP:1.0);")

_, namelist = majorinternodecount(truenet)
D = Matrix(CSV.read("/mnt/dv/wid/projects4/SolisLemus-network-merging/error_logs/dmat_1250434113789644073.csv", DataFrame))
mnet = netnj(D, constraints, namelist)

using PhyloPlots
PhyloPlots.plot(constraints[1])





cc = readTopology("((A,(B,#H1)),(C)#H1);")
_, namelist = majorinternodecount(cc)
D = Matrix{Float64}([0. 2. 3.; 2. 0. 0.; 3. 0. 0.])
mnet = netnj(D, [cc], namelist)