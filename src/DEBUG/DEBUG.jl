using Revise
using InPhyNet, PhyloNetworks, CSV, DataFrames

constraints = [readTopology(c) for c in split("((((t74:0.06975232498,t98:0.06975232498):0.5122327607,(t47:0.3485429448,t11:0.3485429448):0.06199061763):0.2954327585,t22:0.5819850857):0.4803739183,(((((t44:0.10888118298999999,t18:0.06535685099):1.032387956,t50:0.06535685099):0.9888636242,t9:0.108881183):0.005394519902,t84:1.001543291):0.1015960365,t87:1.001543291):0.02121029444);
((((#H205:0.0::0.4439543537,((t66:0.07244771067,t15:0.07244771067):0.3758939293,(t97:0.4323919755,t25:0.4323919755):0.1291679755):0.1132183111):0.3376156448,(t4:0.44834164,(t6:0.44834164)#H205:0.0::0.5560456463):0.4508339559):0.8906251021,(t39:1.696140451,t61:1.696140451):0.09366024682):0.3947187579,(t43:1.409169515,(((t32:0.5064292748,t69:0.5064292748):0.1490893358,t29:0.6555186107):0.6520533536,(t88:1.409169515,(t60:0.3254461452,t67:0.3254461452):0.982125819):0.2778111208):0.1762135705):0.5991363707);
((t59:1.335774509,(((t37:0.5950573677,(t62:0.6160982826,t64:0.5950573677):0.0):0.0)#H197:1.8299136468000001::0.5113971171,t33:1.335774509):1.11023742):0.4133224936,(((t75:0.2407258544,(t89:0.1428203424,t55:0.2407258544):1.969471558):0.6164770475,t8:0.1428203424):1.450900022,((#H197:0.0::0.4886028829,t54:0.08964002618):0.5264582564,t5:0.08964002618):0.1431991074):0.6491370110000001);
((t65:0.006690162929,t80:0.006690162929):1.908225488,((t34:0.1853105636,(t79:0.1853105636,(t36:0.0366255763,t21:0.0366255763):0.7053080148):0.3983432608):0.9549662883,t78:0.7419335911):0.7746387988);
((((t45:0.2704803263,(t13:0.07997726877,(t57:0.2704803263,t46:0.07997726877):0.3473858293):0.1568827718):2.700111962,t52:1.6635608202999999):1.46391424,t73:1.6635608206999999):0.6520238397,((((t24:0.7255677635,(t49:1.072628554,t71:0.7255677635):0.3470607904):1.678898912,t48:0.6915742766):2.059953189,(t40:0.3290845441,t53:0.2571122988):0.07197224531):0.3624897325,t58:0.2571122988):1.0279714333999999);
(t17:2.170862192,(((t72:0.2160406373,(t19:0.2160406373,t99:1.413474):0.2972755965):0.2328852095,(t42:0.5133162339,t96:0.8621338553):0.3488176214):0.3184549357,((((t7:0.258292091,((t68:0.1567002586,(t90:0.1452059855,t56:0.1452059855):0.01149427306):0.1015918324,t70:0.1378963973):0.6273034667):0.7476991604,t12:0.1378963973):0.1574865014,t95:0.3542826087):0.6887994503999999,t76:0.3542826087):0.05193700565):0.7573881916);
(((t91:1.522598198)#H126:0.8270430649::0.5148858896,(((((t86:0.4086192128,t31:0.4086192128):0.0729693229,t83:0.4815885357):0.6184757146,(#H126:0.140962622::0.4851141104,#H159:0.5215393867::0.2794614762):2.6910908187):1.249577013,t14:1.1000642504):0.9082041724,(((t1:1.142956499,(t20:0.8039716656,(t16:0.6972999797,t81:0.6972999796999999):0.1066716859):0.3389848339):0.6586689399,t27:1.801625439):0.647086899,((t10:1.142021434,(t63:1.142021434)#H159:0.0::0.7205385238):0.1933490459,t2:1.33537048):1.113341859):1.9059393):2.913214548),OUTGROUP:1.0);
((t35:0.1003637653,(t38:0.2795262023,(t41:0.09943448524,((t85:0.09943448524)#H219:0.0::0.762258771,t23:0.09943448524):0.0):0.0009292800808):0.179162437):0.5791516509,(#H219:0.1644446907::0.237741229,(t93:0.1200813166,t92:0.1200813166):0.1437978593):0.5947986773);
((t94:0.9322481305,((t100:0.6379303667,(t82:0.1844079624,(t30:0.05143227961,t77:0.05143227961):0.5864980870501001):0.6349173833):0.181394979,(t3:0.02485878439,t26:0.02485878439):0.159549178):0.1129227848):0.6098812826,(t51:0.9647428575,t28:0.9647428575):0.5773865556);", "\n")]

truenet = readTopology("((((((((t52:0.9022349731)#H151:0.6203632252::0.5786665206,#H126:0.0::0.4851141104):0.140962622,(t73:1.142021434,#H159:0.0::0.2794614762):0.5215393867):1.46391424,((t45:0.2704803263,t57:0.2704803263):0.1568827718,(t13:0.07997726877,t46:0.07997726877):0.3473858293):2.700111962):0.6520238397,(((t65:0.006690162929,t80:0.006690162929):1.908225488,((t79:0.1853105636,t34:0.1853105636):0.9549662883,(t78:0.7419335911,(t36:0.0366255763,t21:0.0366255763):0.7053080148):0.3983432608):0.7746387988):1.162724258,((t49:1.072628554,(t24:0.7255677635,t71:0.7255677635):0.3470607904):1.678898912,(((t53:0.2571122988,t58:0.2571122988):0.07197224531,(t40:0.3290845441)#H209:0.0::0.6103175085):0.3624897325,t48:0.6915742766):2.059953189):0.3261124431):0.7018589903):0.575152739,(((t1:1.142956499,(t20:0.8039716656,(t16:0.6972999797,(t81:0.3290845441,#H209:0.0::0.3896824915):0.3682154356):0.1066716859):0.3389848339):0.6586689399,t27:1.801625439):0.647086899,((t10:1.142021434,(t63:1.142021434)#H159:0.0::0.7205385238):0.1933490459,t2:1.33537048):1.113341859):1.9059393):0.9082041724,(((((t86:0.4086192128,t31:0.4086192128):0.0729693229,t83:0.4815885357):0.6184757146,(t14:0.9022349731,#H151:0.0::0.4213334794):0.1978292773):1.249577013,(t91:1.522598198)#H126:0.8270430649::0.5148858896):1.81677306,((t17:2.170862192,((((t42:0.5133162339,(t19:0.2160406373,t72:0.2160406373):0.2972755965):0.3488176214,t96:0.8621338553):0.2328852095,(((t76:0.3542826087,t95:0.3542826087):0.3754729594,#H190:0.620874385::0.4369431324):0.313326491,(((t68:0.1567002586,(t90:0.1452059855,t56:0.1452059855):0.01149427306):0.1015918324,t7:0.258292091):0.6273034667,(t70:0.1378963973,t12:0.1378963973):0.7476991604):0.1574865014):0.05193700565):0.3184549357,t99:1.413474):0.7573881916):0.7871487384,(((((t89:0.1428203424,t8:0.1428203424):0.6164770475,((t5:0.08964002618,t54:0.08964002618):0.5264582564,#H197:0.0::0.4886028829):0.1431991074):1.450900022,(t75:0.2407258544,t55:0.2407258544):1.969471558):0.0569042037,(((((t97:0.4323919755,t25:0.4323919755):0.1291679755,((t66:0.07244771067,t15:0.07244771067):0.3758939293,#H205:0.0::0.4439543537):0.1132183111):0.3376156448,(t4:0.44834164,(t6:0.44834164)#H205:0.0::0.5560456463):0.4508339559):0.8906251021,(t61:1.696140451,t39:1.696140451):0.09366024682):0.3947187579,(#H136:1.054247984::0.2349807652,(((t60:0.3254461452,t67:0.3254461452):0.982125819,((t32:0.5064292748,t69:0.5064292748):0.1490893358,t29:0.6555186107):0.6520533536):0.2778111208,(t43:1.409169515,t88:1.409169515):0.1762135705):0.4336077568):0.1655286139):0.08258215983):0.5922328073,((t59:1.335774509,t33:1.335774509):1.11023742,((t62:0.6160982826,((t37:0.5950573677,t64:0.5950573677):0.02104091492)#H197:0.0::0.5113971171):1.507493258,(((((t35:0.1003637653,(t41:0.09943448524,#H219:0.0::0.237741229):0.0009292800808):0.179162437,t38:0.2795262023):0.5791516509,((t23:0.09943448524,(t85:0.09943448524)#H219:0.0::0.762258771):0.1644446907,(t93:0.1200813166,t92:0.1200813166):0.1437978593):0.5947986773):0.6187373619,(((t47:0.3485429448,t11:0.3485429448):0.2954327585,(t22:0.5819850857,(t74:0.06975232498,t98:0.06975232498):0.5122327607):0.06199061763):0.4803739183,((t84:1.001543291,t87:1.001543291):0.1015960365,((t9:0.108881183,((t44:0.05236016516)#H217:0.05652101783::0.5977123694)#H190:0.0::0.5630568676):0.9888636242,(t50:0.06535685099,t18:0.06535685099):1.032387956):0.005394519902):0.02121029444):0.3530655935):0.08308961654,(((((t3:0.02485878439,t26:0.02485878439):0.159549178,t82:0.1844079624):0.6349173833,(((t30:0.05143227961,t77:0.05143227961):0.0009278855501,#H217:0.0::0.4022876306):0.5855702015,t100:0.6379303667):0.181394979):0.1129227848,t94:0.9322481305):0.6098812826,(t51:0.9647428575,(t28:0.9647428575)#H136:0.0::0.7650192348):0.5773865556):0.01837541855):0.563086709):0.3224203888):0.4133224936):0.09867650745):1.208403393):1.096441488),OUTGROUP:1.0);")

_, namelist = majorinternodedistance(truenet)
D = Matrix(CSV.read("/mnt/home/nkolbow/repos/network-merging/dmat1.csv", DataFrame))
mnet = netnj(D, constraints, namelist)

using PhyloPlots
PhyloPlots.plot(constraints[1])