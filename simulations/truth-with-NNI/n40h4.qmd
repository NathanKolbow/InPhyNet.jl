```{julia}
include("../pipelines.jl")
include("../robustness-fxns.jl")
```

## One NNI move on each constraint

```{julia}
truenet, constraints = loadTrueData("n40h4")
estdists, constraintdists = robustNNI(truenet, constraints, 1)
```

Merged net errors are very closely in line with the sum of induced errors

```{julia}
prettyNNIErrors(estdists, constraintdists)
```

## Two NNI moves on each constraint

```{julia}
truenet, constraints = loadTrueData("n40h4")
estdists, constraintdists = robustNNI(truenet, constraints, 2, nsim=1000)
```

Still tracking closely, but worse

```{julia}
prettyNNIErrors(estdists, constraintdists)
```

## Three NNI moves on each constraint

```{julia}
truenet, constraints = loadTrueData("n40h4")
estdists, constraintdists = robustNNI(truenet, constraints, 3, nsim=1000)
```

This actually seems maybe a bit better than with two NNI moves, relatively speaking

```{julia}
prettyNNIErrors(estdists, constraintdists)
```

## TEN NNI moves on each constraint

```{julia}
truenet, constraints = loadTrueData("n40h4")
estdists, constraintdists = robustNNI(truenet, constraints, 10, nsim=100)
```



```{julia}
prettyNNIErrors(estdists, constraintdists)
```