library(ggplot2)
library(ggtree)


n200r10_rep2_truth <- read.tree(text="(OUTGROUP,(((((t141,t142),(((t135,t136),((t139,t140),((t147,t148),(t149,t150)))),(((t127,(t128,t129)),(((((t138,t137),(t143,t144)),t132),(t133,t134)),(t130,t131))),(t126,(t145,t146))))),((((t159,t160),(((t169,(t172,t173)),(t170,t171)),((((t158,((t167,t168),t161)),((t165,t166),t157)),t156),t153))),(((t151,(t152,(t154,t155))),(t162,(t174,t175))),(t163,t164))),((((t177,((t189,t190),(t199,t200))),t176),((t180,(t181,(t193,t194))),t179)),((t185,t186),(((t195,t196),(t184,((t191,t192),t187))),((t178,(t188,(t197,t198))),(t182,t183))))))),((((t1,(t16,t24)),(t2,(t3,t4))),((((((t15,(t17,t18)),t14),(t23,t25)),t13),(t11,t12)),(t5,(t6,((t19,t20),t10))))),((t7,t8),((t21,t22),t9)))),((((((t86,t87),(((t77,(t79,t80)),((t95,t96),(t92,t94))),t93)),((((t99,t100),((t88,t89),(((t97,t98),t83),((t82,(t90,t91)),(t84,t85))))),t76),(t78,t81))),((((t111,t112),t105),t101),(((((t115,(t116,t117)),(t122,t123)),(t118,t119)),(t103,((t120,t121),((t124,t125),t108)))),((((t104,(t109,t110)),t102),(t106,t107)),(t113,t114))))),(((t56,t57),t51),(((((t65,t66),(t70,t71)),t59),t58),(((t60,t61),(t64,(t73,t72))),(t52,((t54,t55),((((t74,t75),t68),((t62,t63),(t67,t69))),t53))))))),(((t29,(t30,t31)),((((t40,((t42,(t49,t50)),t41)),t32),((t43,t44),t37)),((t38,t39),(t45,t46)))),((t26,((t28,(t47,t48)),(t35,t36))),((t33,t34),t27))))));")

n200r10_rep2_est <- read.tree(text="(OUTGROUP,(((((t141,t142),((((((((t143,t144),(t138,t137)),t132),(t133,t134)),(t130,t131)),((t128,t129),t127)),(t126,(t146,t145))),(((t150,((t148,t147),t149)),(t139,t140)),(t136,t135)))),((((t186,t185),(((((t197,t198),t188),t178),(t182,t183)),((t184,(t187,(t192,t191))),(t195,t196)))),(((((t189,t190),(t200,t199)),t177),t176),(((t181,(t193,t194)),t180),t179))),(((((t169,(t173,t172)),((((t157,(t165,t166)),((t161,(t168,t167)),t158)),t156),t153)),(t171,t170)),(t159,t160)),((t163,t164),((t162,(t175,t174)),(t151,((t154,t155),t152))))))),((((t22,t21),t9),(t7,t8)),((((t24,t16),t1),(t2,(t4,t3))),((((((t14,(t15,(t17,t18))),t23),t13),t25),(t12,t11)),(t5,(((t20,t19),t10),t6)))))),((((((t38,t39),(t46,t45)),(((t44,t43),t37),(t32,(t40,(((t50,t49),t42),t41))))),((t31,t29),t30)),(((t34,t33),t27),(((t28,(t48,t47)),(t36,t35)),t26))),(((((((t71,t70),(t65,t66)),t58),t59),((((t64,t73),t72),(t60,t61)),((((((t63,t62),(t67,t69)),((t75,t74),t68)),t53),(t54,t55)),t52))),(t51,(t57,t56))),(((((t113,t114),((t106,t107),(t102,((t110,t109),t104)))),((((t115,(t116,t117)),(t123,t122)),(t119,t118)),(t103,(((t124,t125),t108),(t121,t120))))),((t105,(t112,t111)),t101)),(((t81,t78),((((((t89,t88),((t98,t97),t83)),(t100,t99)),((t91,t90),t82)),t76),(t84,t85))),((t86,t87),(((t80,(t79,t77)),((t95,t96),(t92,t94))),t93))))))));")
n200r10_rep2_seq500_est <- read.tree(text="(OUTGROUP,(((((((t81,t78),((((((t89,t88),((t98,t97),(t83,#H4))),((t91,t90),t82)),(t100,t99)),t76),(t84,(t85)#H4))),((t86,t87),(((t80,(t79,t77)),((t95,t96),(t92,(t94)#H1))),(t93,#H1)))),((((t113,t114),((t106,t107),(((t109,t110),t104),t102))),((((t115,(t116,t117)),(t123,t122)),(t119,t118)),(t103,(((t124,t125),t108),(t120,t121))))),((t105,(t112,t111)),t101))),((((((t71,t70),(t65,t66)),t58),t59),((((t64,t73),t72),(t60,t61)),((((((t63,t62),(t67,(t69)#H3)),((t75,t74),(t68,#H3))),t53),(t55,t54)),t52))),(t51,(t57,t56)))),(((((t38,t39),(t46,t45)),(((t44,t43),t37),(t32,(t40,(((t49,t50),t42),t41))))),((t31,t30),t29)),(((t34,t33),t27),(((t28,(t48,t47)),(t36,t35)),t26)))),(((((t22,t21),t9),(t7,t8)),((((t24,t16),t1),(t2,(t4,t3))),((((((t14,(t15,(t17,t18))),t23),t13),t25),(t12,t11)),(t5,(((t20,t19),t6),t10))))),((((t141,t142),(((t150,((t148,t147),t149)),(t139,t140)),(t136,t135))),(((((((t143,t144),(t138,(t137)#H2)),t132),(t133,t134)),(t130,t131)),((t128,(t129,#H2)),t127)),(t126,(t146,t145)))),((((t186,t185),(((((t197,t198),t188),t178),(t182,t183)),((t184,(t187,(t192,t191))),(t195,t196)))),(((((t189,t190),(t200,t199)),t177),t176),((t181,(t180,(t193,t194))),t179))),((t159,t160),(((((t169,(t173,t172)),((((t157,(t165,t166)),((t161,(t168,t167)),t158)),t156),t153)),(t171,t170)),(t163,t164)),((t162,(t175,t174)),(t151,(t152,(t155,t154)))))))))));")

tip_categories <- tibble(
    tip_name = c(paste0("t", 1:200), "OUTGROUP"),
    clade_number = c(((1:200 - 1) %/% 25), "OUTGROUP")
)

plot_colored_tree <- function(tre, title = "") {
    ggtree(tre) %<+% tip_categories +
        geom_tiplab(aes(fill = factor(clade_number)),
            color = "black",
            geom = "label",
            label.padding = unit(0.15, "lines"),
            label.size = 0) +
        labs(fill = "Clade ID", title = title)
}

plot_colored_tree(n200r10_rep2_truth, title = "True major tree")
plot_colored_tree(n200r10_rep2_est, title = "Estimated major tree")
plot_colored_tree(n200r10_rep2_seq500_est, title = "Estimated major tree")
