library(ggplot2)
library(ggtree)

# df[92,!] in julia
tru <- read.tree(text="((((((((t174:0.043,t175:0.043):0.722,t155:0.764):0.435,(((t160:0.548,t161:0.548):0.004,t159:0.552):0.361,(t170:0.173,t171:0.173):0.739):0.286):1.214,((((t158:0.572)#H9:1.036::0.754,(t152:1.099,t153:1.099):0.508):0.404,t151:2.011):0.296,(((t172:0.048,t173:0.048):0.951,(t154:0.855,(((t166:0.365)#H10:0.101::0.507,t162:0.466):0.107,(t163:0.455,(t164:0.431,t165:0.431):0.024):0.118):0.283):0.144):0.87,((t157:0.634,((t168:0.189,t169:0.189):0.383,#H9:0.0::0.246):0.062):0.708,((t167:0.365,#H10:0.0::0.493):0.347,t156:0.711):0.631):0.527):0.438):0.106):0.112,(((t179:0.945,(t183:0.716,((t199:0.026,t200:0.026):0.24,(t191:0.189,t192:0.189):0.077):0.45):0.229):0.816,((t193:0.169,t194:0.169):0.817,((t180:0.785,t181:0.785):0.025,(t182:0.754,(((t188:0.3,t189:0.3):0.207,t185:0.507):0.023,t184:0.531):0.224):0.056):0.175):0.776):1.733,(((t177:1.677,(t178:1.266,(t197:0.04,t198:0.04):1.227):0.41):0.191,((t190:0.219,(t195:0.081,t196:0.081):0.138):0.886,(t186:0.302,t187:0.302):0.803):0.763):0.074,t176:1.942):1.553):0.112):1.708,(((((t11:0.302,(t12:0.296,t13:0.296):0.006):0.227,(((t14:0.282,t15:0.282):0.066,(t16:0.108,((t22:0.025,t23:0.025):0.001,t21:0.026):0.082):0.24):0.026,t8:0.374):0.155):0.683,(t6:0.493,t7:0.493):0.719):0.168,(t19:0.036,t20:0.036):1.344):1.786,(t1:1.474,((((t4:0.876,t5:0.876):0.202,t3:1.078):0.138,(((t9:0.37,t10:0.37):0.13,(t17:0.046,t18:0.046):0.454):0.181,(t24:0.009,t25:0.009):0.672):0.535):0.235,t2:1.45):0.024):1.692):1.82):0.409,((((((t56:0.42,((t72:0.085,t73:0.085):0.335)#H4:0.0::0.593):1.141,(t55:0.422,(t64:0.247,t65:0.247):0.175):1.139):0.165,((((t54:0.464,(t68:0.176,t69:0.176):0.289):0.706,t51:1.17):0.079,((t60:0.328,t61:0.328):0.092,#H4:0.0::0.407):0.829):0.391,(t59:0.368,(t74:0.025,t75:0.025):0.343):1.272):0.086):1.444,((t52:0.911,(t70:0.13,t71:0.13):0.78):0.777,((t62:0.254,t63:0.254):1.432,((t57:0.379,t58:0.379):1.14,(t53:0.536,(t66:0.238,t67:0.238):0.298):0.983):0.167):0.002):1.482):0.131,((((((t92:0.123,t93:0.123):0.454,(t83:0.271,t84:0.271):0.306):0.544,(t78:0.687,t79:0.687):0.433):0.134,t77:1.254):0.123,(t76:1.293,(((t90:0.169,t91:0.169):0.171,((t81:0.313,t82:0.313):0.001,((t99:0.028,t100:0.028):0.086,t94:0.114):0.2):0.026):0.19,((t85:0.249,t86:0.249):0.093,t80:0.341):0.189):0.762):0.084):0.5,(((t88:0.179,t89:0.179):0.296,(t97:0.05,t98:0.05):0.424):0.016,((t95:0.109,t96:0.109):0.089,t87:0.198):0.293):1.386):0.131):1.629,(((((t106:0.419,((t107:0.368)#H5:0.051::0.532)#H6:0.0::0.539):1.937,((t102:1.15,((t104:0.692,#H7:0.306::0.481):0.278,((t118:0.067,t119:0.067):0.385,(((((t122:0.016,t123:0.016):0.222,(t114:0.154,t115:0.154):0.085):0.147)#H7:0.0::0.519,(t108:0.343,t109:0.343):0.043):0.034,#H6:0.0::0.461):0.033):0.518):0.18):0.387,((t105:0.572,(((t124:0.015,t125:0.015):0.109,(t117:0.124)#H8:0.0::0.562):0.341,((t110:0.329,(t120:0.043,t121:0.043):0.285):0.04,#H5:0.0::0.468):0.096):0.108):0.927,(t116:0.124,#H8:0.0::0.438):1.375):0.038):0.82):0.853,((((t112:0.228,t113:0.228):0.051,t111:0.279):0.68,t103:0.959):2.091,t101:3.05):0.159):0.118,(((((t145:0.162,t146:0.162):0.043,t142:0.205):0.238,t140:0.442):1.348,(t126:1.775,((t132:0.764,t133:0.764):0.541,((((t149:0.054,t150:0.054):0.85,t130:0.904):0.213,(t138:0.542,t139:0.542):0.575):0.112,t128:1.228):0.077):0.47):0.016):0.237,(((((t134:0.574,t135:0.574):0.361,((t141:0.25,(t143:0.2,t144:0.2):0.05):0.508,(t147:0.096,t148:0.096):0.662):0.177):0.183,t129:1.118):0.215,t127:1.333):0.063,(t131:0.789,(t136:0.565,t137:0.565):0.224):0.607):0.632):0.118):1.087,((((((t43:0.179,t44:0.179):0.941,(((t41:0.438,#H1:0.0::0.443):0.46,t33:0.899):0.087,t30:0.985):0.135):0.312,(t37:0.647,t38:0.647):0.785):0.815,(((t28:1.526,(t35:0.698,(((t47:0.088,t48:0.088):0.286,t42:0.373):0.065)#H1:0.26::0.557):0.827):0.226,((((t49:0.003,t50:0.003):0.901,t32:0.903):0.059)#H2:0.0::0.646,t31:0.962):0.79):0.388,(t27:1.568,((t39:0.49,t40:0.49):0.187,t36:0.677):0.892):0.571):0.108):0.0,#H3:0.0::0.428):0.097,(((t29:1.023,#H2:0.06::0.354):0.82,(t26:1.641,((t45:0.166,t46:0.166):0.586,t34:0.752):0.889):0.202):0.405)#H3:0.097::0.572):1.204):0.556):0.469):0.454,OUTGROUP:1.0);")

est <- read.tree(text="(OUTGROUP,((((t1,(((((t10,t9),(t17,t18)),(t24,t25)),((t3,t5),t4)),t2)),((((t11,(t12,t13)),(((t14,t15),(t16,((t21,t23),t22))),t8)),(t6,t7)),(t19,t20))),((((t151,((t152,t158),t153)),(((t156,t167),(t157,(t168,(t169,#H2)))),(((t154,((t162,(t163,(t164,t165))),t166)),(t172,t173)))#H2)),((t155,(t174,t175)),(((t159,t161),t160),(t170,t171)))),((t176,((t177,(t178,(t197,t198))),((t186,t187),(t190,(t195,t196))))),((t179,(t183,((t191,(t199,t200)),t192))),(((t180,t181),(t182,(t184,(t185,(t188,t189))))),(t193,t194)))))),(((((((((t100,(t94,t99)),t81),(t82,(t90,t91))),(t80,(t85,t86))),t76),(t77,(t78,(t79,((t83,t84),(t92,t93)))))),((t87,(t95,t96)),((t88,t89),(t97,t98)))),((((((t54,(t51)#H3),(t68,t69)),(t60,t61)),(t59,((t74,t75),#H3))),((t55,(t64,t65)),(t56,(t72,t73)))),((((t52,t71),t70),(((t53,t67),t66),(t57,t58))),(t62,t63)))),(((((t101,(t103,(t111,t113))),t112),(((((t102,(t104,(((t115,((t108,t109),#H4)),(((t114,t119),t118),t123)),t122))),(t107)#H4),((t105,((t110,(t120,t121)),(t125,(t124,#H1)))),(t117)#H1)),t106),t116)),(((t126,((t128,((t130,(t149,t150)),(t138,t139))),(t132,t133))),((t140,(t145,t146)),t142)),(t127,(((t129,((t134,t135),(((t141,t144),t143),(t147,t148)))),(t136,t137)),t131)))),(((t26,t29),(t34,(t45,t46))),(((((t30,(t33,t41)),(t43,t44)),(t37,t38)),(t42,(t47,t48))),(t28,((((t27,t36),(t39,t40)),((t31,(t49,t50)),t32)),t35))))))));")

tip_categories <- tibble(
    tip_name = c(paste0("t", 1:200), "OUTGROUP"),
    clade_number = c(((1:200 - 1) %/% 25), "OUTGROUP")
)

plot_colored_tree <- function(tre, title = "") {
    ggtree(tre) %<+% tip_categories +
        geom_tiplab(aes(fill = factor(clade_number)),
            color = "black",
            geom = "label",
            label.padding = unit(0.15, "lines"),
            label.size = 0) +
        labs(fill = "Clade ID", title = title)
}

plot_colored_tree(tru, title = "True major tree")
plot_colored_tree(est, title = "Estimated major tree")
